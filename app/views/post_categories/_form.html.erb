
<%= form_with model: entity, html: { id: 'post-category-form' } do |f| %>
    <%= render partial: 'shared/list_of_errors', locals: { entity: entity } %>

    <dl>
      <% unless entity.id.nil? %>
          <dt><%= t('activerecord.attributes.post_category.post_type_id') %></dt>
          <dd>
            <%= admin_post_type_link(entity.post_type) %>
          </dd>
          <% unless entity.parent_id.nil? %>
              <dt><%= t('activerecord.attributes.post_category.parent_id') %></dt>
              <dd>
                <%= admin_post_category_link(entity.parent) %>
              </dd>
          <% end %>
      <% end %>

      <dt><%= f.label :name %></dt>
      <dd>
        <%= f.text_field :name, id: :post_category_name, size: nil, maxlength: PostCategory::NAME_LIMIT, required: true, data: { transliterate: 'post_category_slug' } %>
        <div class="guideline"><%= t('.guidelines.name') %></div>
      </dd>

      <dt><%= f.label :slug %></dt>
      <dd>
        <%= f.text_field :slug, id: :post_category_slug, size: nil, maxlength: PostCategory::SLUG_LIMIT, required: true %>
        <div class="guideline"><%= t('.guidelines.slug') %></div>
      </dd>

      <dt><%= f.label :priority %></dt>
      <dd><%= f.number_field :priority, id: :post_category_priority, in: PostCategory::PRIORITY_RANGE, required: true %></dd>

      <dt><%= t(:flags) %></dt>
      <dd>
        <ul class="flags">
          <li>
            <%= f.check_box :visible, id: :post_category_visible %>
            <%= f.label :visible %>
          </li>
        </ul>
      </dd>
    </dl>

    <div class="buttons">
      <% if entity.id.nil? %>
          <%= f.hidden_field :post_type_id %>
          <%= f.hidden_field :parent_id %>
      <% end %>
      <%= f.button t(:save), type: :submit %>
    </div>
<% end %>

<script>
    'use strict';

    document.addEventListener('DOMContentLoaded', function () {
        const form = document.getElementById('post-category-form');
        const button = form.querySelector('button[type=submit]');

        form.addEventListener('ajax:before', function() {
            button.disabled = true;
        });

        form.addEventListener('ajax:complete', function(request, status) {
            button.disabled = false;
        });
    });
</script>
